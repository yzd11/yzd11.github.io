<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="referrer" content="no-referrer"><title>训练神经网络 - yzd&#039;s Log Book</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="yzd&#039;s Log Book"><meta name="msapplication-TileImage" content="https://s2.loli.net/2024/11/11/wIobSZOAEGchgVv.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="yzd&#039;s Log Book"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="训练神经网络的小技巧"><meta property="og:type" content="blog"><meta property="og:title" content="训练神经网络"><meta property="og:url" content="https://yzd11.github.io/2024/09/21/%E8%AE%AD%E7%BB%83%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"><meta property="og:site_name" content="yzd&#039;s Log Book"><meta property="og:description" content="训练神经网络的小技巧"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729081705591-33325710-f2f0-4bd5-a7cf-e07314ebe6af.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729083375965-04883ad7-6a31-432b-9777-280ce77483fb.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729083448461-37e20bea-a894-46e4-843d-19c686ec43dc.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/jpeg/40370285/1729083659471-6d876ba8-ac85-4116-ad57-a36909bf7cbb.jpeg"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/jpeg/40370285/1729083676938-e6047976-a8fa-4f97-9438-ba6b55fa87bd.jpeg"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/jpeg/40370285/1729083607521-b0893af1-5a10-4ae8-b6f6-02551086c8da.jpeg"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/jpeg/40370285/1729083692163-861f99c0-2714-437a-baa9-30675812d032.jpeg"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729084952863-2a35b60e-dc8f-42e9-853f-75cf84631a91.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729085047797-b16efb05-dfbe-47e8-ba5c-48e3cfec47f8.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729085923625-a38987c3-73aa-4739-a3e2-b48896596421.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729086363022-abbf0131-ad4d-4a09-99a2-87d86429a224.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729086453019-529a7044-ef92-4839-924c-c10cd665fc18.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729173256714-ad3d5a09-23a5-42d9-afad-7a2bd26c4d43.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729173323452-70250ee2-a25b-4037-97f4-4699804fd364.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729173555513-eb0f3848-bc0f-46fc-a1e5-12c4911a87c2.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729173659288-06b6b255-a811-415a-9f07-5cd4d173d6bd.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729175652858-1291a305-e345-4cc2-9325-b3b842e1831d.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729320742706-5518fd74-7f1d-44c5-a717-6e9a584e3df7.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729321235775-1d7a856c-5f80-482a-a196-fb2940099d8e.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729321584786-9d7c178f-5f40-4b0d-8941-e3fcee4da95b.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729321759318-92df4fe8-3794-402c-a89a-2a8c4f05f97b.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729342632635-b3b37866-87ec-485c-ae9b-0910526aabe4.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729344781676-ed3b6333-1148-4b93-955f-0059471ef4b2.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729345293261-9d2f52a8-8802-4fc3-a04c-3918d6a7e0d8.png"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729346541847-5f17379f-08cc-4a73-9789-98a05a6ddc26.png"><meta property="article:published_time" content="2024-09-21T04:51:47.000Z"><meta property="article:modified_time" content="2024-11-11T05:54:16.322Z"><meta property="article:author" content="yzd"><meta property="article:tag" content="Deep Learning"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729081705591-33325710-f2f0-4bd5-a7cf-e07314ebe6af.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://yzd11.github.io/2024/09/21/%E8%AE%AD%E7%BB%83%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"},"headline":"训练神经网络","image":["https://cdn.nlark.com/yuque/0/2024/png/40370285/1729081705591-33325710-f2f0-4bd5-a7cf-e07314ebe6af.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729083375965-04883ad7-6a31-432b-9777-280ce77483fb.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729083448461-37e20bea-a894-46e4-843d-19c686ec43dc.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729084952863-2a35b60e-dc8f-42e9-853f-75cf84631a91.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729085047797-b16efb05-dfbe-47e8-ba5c-48e3cfec47f8.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729085923625-a38987c3-73aa-4739-a3e2-b48896596421.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729086363022-abbf0131-ad4d-4a09-99a2-87d86429a224.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729086453019-529a7044-ef92-4839-924c-c10cd665fc18.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729173256714-ad3d5a09-23a5-42d9-afad-7a2bd26c4d43.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729173323452-70250ee2-a25b-4037-97f4-4699804fd364.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729173555513-eb0f3848-bc0f-46fc-a1e5-12c4911a87c2.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729173659288-06b6b255-a811-415a-9f07-5cd4d173d6bd.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729175652858-1291a305-e345-4cc2-9325-b3b842e1831d.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729320742706-5518fd74-7f1d-44c5-a717-6e9a584e3df7.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729321235775-1d7a856c-5f80-482a-a196-fb2940099d8e.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729321584786-9d7c178f-5f40-4b0d-8941-e3fcee4da95b.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729321759318-92df4fe8-3794-402c-a89a-2a8c4f05f97b.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729342632635-b3b37866-87ec-485c-ae9b-0910526aabe4.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729344781676-ed3b6333-1148-4b93-955f-0059471ef4b2.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729345293261-9d2f52a8-8802-4fc3-a04c-3918d6a7e0d8.png","https://cdn.nlark.com/yuque/0/2024/png/40370285/1729346541847-5f17379f-08cc-4a73-9789-98a05a6ddc26.png"],"datePublished":"2024-09-21T04:51:47.000Z","dateModified":"2024-11-11T05:54:16.322Z","author":{"@type":"Person","name":"yzd"},"publisher":{"@type":"Organization","name":"yzd's Log Book","logo":{"@type":"ImageObject","url":"https://s2.loli.net/2024/11/11/wIobSZOAEGchgVv.png"}},"description":"训练神经网络的小技巧"}</script><link rel="canonical" href="https://yzd11.github.io/2024/09/21/%E8%AE%AD%E7%BB%83%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"><link rel="icon" href="https://s2.loli.net/2024/11/11/wIobSZOAEGchgVv.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://s2.loli.net/2024/11/11/wIobSZOAEGchgVv.png" alt="yzd&#039;s Log Book" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">YZD&#039;S LOG BOOK</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/yzd11/"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-09-21T04:51:47.000Z" title="2024/9/21 12:51:47">2024-09-21</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-11-11T05:54:16.322Z" title="2024/11/11 13:54:16">2024-11-11</time></span><span class="level-item"><a class="link-muted" href="/categories/blog/">blog</a></span><span class="level-item">19 minutes read (About 2781 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">训练神经网络</h1><div class="content"><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729081705591-33325710-f2f0-4bd5-a7cf-e07314ebe6af.png"></p>
<p>在选择数据时，我们可以选择一次性使用全部的数据进行训练，但是这样的计算量太大，还可以选择每次选择一个数据进行计算，但是这样容易受到噪音的干扰，因此我们希望采用一种更加折中的方式，即采用小批量随机梯度下降法。</p>
<p>这样既没有那么震荡，也没有那么大的计算量。</p>
<h2 id="MSOSW">激活函数选择</h2>
<h3 id="xaZzg">sigmod</h3>
![](https://cdn.nlark.com/yuque/0/2024/png/40370285/1729083293551-d9df5ed0-f986-4a8d-8f46-a5df1b74988d.png)

<ul>
<li>梯度消失问题</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729083375965-04883ad7-6a31-432b-9777-280ce77483fb.png"></p>
<p>可以看到当$ x $过大或过小时，很容易造成梯度消失的问题，这不利于对于参数的调整。</p>
<ul>
<li>不关于$ 0 $对称问题</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729083448461-37e20bea-a894-46e4-843d-19c686ec43dc.png"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/40370285/1729083659471-6d876ba8-ac85-4116-ad57-a36909bf7cbb.jpeg"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/40370285/1729083676938-e6047976-a8fa-4f97-9438-ba6b55fa87bd.jpeg"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/40370285/1729083607521-b0893af1-5a10-4ae8-b6f6-02551086c8da.jpeg"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/40370285/1729083692163-861f99c0-2714-437a-baa9-30675812d032.jpeg"></p>
<ul>
<li>指数运算问题</li>
</ul>
<p>在进行指数运算时容易产生很大的计算开销。</p>
<h3 id="jcp7h">tanh</h3>
![](https://cdn.nlark.com/yuque/0/2024/png/40370285/1729083847777-efadf0c5-ef10-4c57-8278-03bae07aad7a.png)

<p>$ \tanh(x)&#x3D;\frac{e^x-e^{-x}}{e^x+e^{-x}} $，实际上是关于$ sigmod $函数的变型，也就是$ tanh(x)&#x3D;2sigmoid(2x)-1 $。</p>
<p>避免了不关于原点对称的$ zig-zag $问题，但仍存在梯度消失问题。</p>
<h3 id="tf51U">ReLU</h3>
![](https://cdn.nlark.com/yuque/0/2024/png/40370285/1729084715218-52922c2b-8a7f-47c6-9abd-8f31bd385a3e.png)

<p>关于$ ReLU $激活函数具有不饱和，计算快，收敛快这一系列优点，但是它仍具有不关于$ 0 $对称，并且在$ x&lt;0 $的情况下它的输出为$ 0 $。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729084952863-2a35b60e-dc8f-42e9-853f-75cf84631a91.png"></p>
<p>由于这个函数在$ x&lt;0 $时梯度为$ 0 $，因此会出现一种$ Dead\  ReLU $的问题，即<font style="color:rgb(51, 51, 51);">当输入为负时，梯度为0。这个神经元及之后的神经元梯度永远为0，不再对任何数据有所响应，导致相应参数永远不会被更新。</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729085047797-b16efb05-dfbe-47e8-ba5c-48e3cfec47f8.png"></p>
<p>这种情况可能是由于初始化不好，或者学习率过大导致改变幅度过大到一个$ Dead \  ReLU $的地方再也出不去。为了解决这个问题通常加上一个偏置项在初始化中，避免开始就进入了$ Dead\  ReLU $。</p>
<h3 id="U9BRf">Leaky ReLU</h3>
![](https://cdn.nlark.com/yuque/0/2024/png/40370285/1729085280176-245fca06-2f14-41f8-b8ec-08387528fc37.png)

<p>对于前面的$ ReLU $的神经元梯度为$ 0 $的问题，我们可以使用$ Leaky\  ReLU $的方式。</p>
<h3 id="MXpbp">ELU</h3>
![](https://cdn.nlark.com/yuque/0/2024/png/40370285/1729085388503-3288ce2c-66d0-410b-9cde-47642ca03158.png)

<p>进一步使得输出接近关于$ 0 $对称，但同时指数的运算也带来了较大的运算量。</p>
<h3 id="AEV9z">Maxout</h3>
![](https://cdn.nlark.com/yuque/0/2024/png/40370285/1729085591831-c356c660-62e4-44d8-85c7-5c84f49e8b26.png)

<p>通过在两个神经元后面再加上一层神经元，其中有$ k $个神经元，参数个数也成$ k $倍增加。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729085923625-a38987c3-73aa-4739-a3e2-b48896596421.png"></p>
<p>总结一下，多使用$ ReLU $，但是要注意它的学习率，不要在中间层使用$ sigmod $函数，可能是因为计算量太大还会有$ zig-zag $问题。</p>
<h2 id="cOOxp">数据预处理</h2>
+ 标准化处理

<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729086363022-abbf0131-ad4d-4a09-99a2-87d86429a224.png"></p>
<p>通过标准化，使其分布更加均匀，关于标准正态的解释可以使用中心极限定理解释，原始分布在$ n $足够大时近似为正态分布。</p>
<ul>
<li>主成分分析</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729086453019-529a7044-ef92-4839-924c-c10cd665fc18.png"></p>
<p>首先通过主成分分析将数据转化在一个二维空间中，再进行标准化，这也被称为$ PCA $白化，然后将其重新变回之前所在的维度，这被称为$ ZCA $白化。</p>
<h2 id="N8Lvp">权重初始化</h2>
![](https://cdn.nlark.com/yuque/0/2024/png/40370285/1729153833137-7c830c68-0c65-4181-8b0e-ae8dc1056a44.png)

<p>我们可能认为由于最终都有梯度下降进行迭代，那么无论怎么进行权重初始化都没有什么影响，但是实际上。如果我们给同一层的神经元一个相同的值，那么对于相同的输入，相同的权重，自然会导致相同的输出，相同的反向传播梯度，相同的更新，那么无论我们具有多少神经元本质上都是仅仅只有一个，因此权重初始化是一个很重要的问题。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729173256714-ad3d5a09-23a5-42d9-afad-7a2bd26c4d43.png"></p>
<p>当初始化的权重过小时，输出全部都分布在$ 0 $这个地方，那么就会导致梯度为$ 0 $。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729173323452-70250ee2-a25b-4037-97f4-4699804fd364.png"></p>
<p>当权重增大时，输出不全为$ 0 $，但是激活函数的导数全部为$ 0 $，那么梯度也为$ 0 $。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729173555513-eb0f3848-bc0f-46fc-a1e5-12c4911a87c2.png"></p>
<p>为了使得输入的方差和输出的方差相同，我们可以使用$ Xavier $的方式进行权重初始化。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729173659288-06b6b255-a811-415a-9f07-5cd4d173d6bd.png"></p>
<p>使用将权重的方差设置为符合$ (0,\frac{1}{d}) $的正态分布，也就可以保证输入的方差和输出的方差相同（但是上面的图我还是有些看不明白，既然保持不变那么为什么还会减小，直到最后几层才保持不变，是因为没有考虑激活函数的影响吗）</p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729175652858-1291a305-e345-4cc2-9325-b3b842e1831d.png"></p>
<p>对于不是关于$ 0 $对称的$ ReLU $，可以使用$ Kaiming $初始化的方法。</p>
<h2 id="emxVG">批量归一化</h2>
![](https://cdn.nlark.com/yuque/0/2024/png/40370285/1729261454641-78f66195-843d-41e1-b1b1-1957ba3b42b6.png)

<p>在进行深层的神经网络训练中，顶层的梯度很大，但是越往下层的梯度就越小，因此底层的收敛速度就很慢，因此在底层进行收敛的时候导致顶层原本学习好的数据重新学习，这无疑是低效的，因此我们希望可以每层的输出和梯度都保持在一个固定的分布。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729320742706-5518fd74-7f1d-44c5-a717-6e9a584e3df7.png"></p>
<p>具体的就是计算每个小批量的均值和方差，方差计算中需要加上一个$ \epsilon $，避免计算时分母为$ 0 $的情况。同时可能标准正态分布并不满足要求，因此可以使用$ \gamma,\beta $来调整方差和均值。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729321235775-1d7a856c-5f80-482a-a196-fb2940099d8e.png"></p>
<p>当作用在输出上时，这个批量归一化的操作需要在激活函数之前，因为如果先进行了非线性的改变在进行批量归一化，例如$ ReLU $将很多输出都设置为$ 0 $，这时的意义不是很大。</p>
<p>当作用在输入时，这个批量归一化对于全连接来讲就是对于每一个特征计算对应的均值和方差，对于卷积层来讲就是将每个通道维的全部像素点作为样本，因此每个通道维就是特征，计算每个通道维的均值和方差。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729321584786-9d7c178f-5f40-4b0d-8941-e3fcee4da95b.png">对于批量归一化到底是在做什么不太好判断，一开始认为是减少内部变量的转移，后来又认为是在小批量中加入噪音。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729321759318-92df4fe8-3794-402c-a89a-2a8c4f05f97b.png"></p>
<p>批量归一化通过固定均值和方差，然后加上可调整的偏移和缩放，这样做可以使得训练加快，但是无法改变模型的精度本身。</p>
<h2 id="wzYCb">优化算法</h2>
<h3 id="r2WAy">SGD</h3>
![](https://cdn.nlark.com/yuque/0/2024/png/40370285/1729342513431-2c22c3e1-46e1-4d22-9000-303f0e29f814.png)

<p>在开始介绍了梯度下降，随机梯度下降，小批量随机梯度下降这三种方法，但是对于这些方法来讲，除了使用全部数据的梯度下降，都存在震荡的情况。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729342632635-b3b37866-87ec-485c-ae9b-0910526aabe4.png"></p>
<p>更有甚者，可能会出现陷入局部最优点，鞍点的情况，对于这种情况，可以考虑加上一个动量。</p>
<h3 id="lpm3A">SGD+Momentum</h3>
![](https://cdn.nlark.com/yuque/0/2024/png/40370285/1729342823936-9add071e-08b3-49b5-abeb-2415af93f9b5.png)

<p>即不是仅仅使用梯度本身，而是使用一个$ v_t $，使用$ v_t&#x3D;{\beta}v_{t-1}+g_t $，这样展开的话就是一个平滑的梯度，其中的$ \beta $作为一个超参数，当批量较大时也可以设置一个较大的$ \beta $，这样可以考虑更多的数据。</p>
<h3 id="PNqZl">Nesterov Momentum</h3>
![](https://cdn.nlark.com/yuque/0/2024/png/40370285/1729343344172-00d6faa0-ee3f-4fc4-ba0a-7b53475cc7ed.png)

<p>刚刚使用的$ Momentum $的方法很好用，但是还可以更好的改进，尽然要使用$ v_t $，那就使用加上$ v_t $之后的梯度，向前看一步，显然使用$ a $这个梯度是要好于$ b $的。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729344781676-ed3b6333-1148-4b93-955f-0059471ef4b2.png"></p>
<p>图中的点标注有点错误，应该是$ X_t+1 $。</p>
<h3 id="cIV0b">AdaGrad</h3>
![](https://cdn.nlark.com/yuque/0/2024/png/40370285/1729345008404-dc61e6f8-80cb-4666-b049-4a3b2b06ab02.png)

<p>在$ AdaGrad $中使用了对梯度进行惩罚的方式，但是因为$ grad_squared $是一个累加和，随着这个数的越来越大在后面的更新可能会越来越慢。</p>
<p>$ RMSProp $ <img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729345293261-9d2f52a8-8802-4fc3-a04c-3918d6a7e0d8.png"></p>
<p>为了解决上面的问题，引入了一个$ decay_{rate} $进行衰减，通过这个值选择保留多少之前的$ grad_squared $。</p>
<h3 id="dd597">Adam</h3>
![](https://cdn.nlark.com/yuque/0/2024/png/40370285/1729345824803-cd08189c-7207-44a6-b64b-14fec9db535f.png)

<p>上面的$ Momentum $考虑了之前的累加和，$ AdaGrad $即考虑了对较大的梯度进行惩罚，现在将这两种方法加在一起就有了$ Adam $优化算法。</p>
<p>但是这个的第一动量和第二动量在开始的时候都起不到什么作用，因此可以进行优化。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/40370285/1729346541847-5f17379f-08cc-4a73-9789-98a05a6ddc26.png"></p>
<p>开始的时候$ t $很小，因此$ 1\ -\ beta1\ ^{**}\ t $的值就很小，因此$ first_unbias $就很大，使得这个值在开始的时候不会不起作用，随着时间的累积，这个值和原本的$ first_moment $自然越来越接近。</p>
<p>上述提到的这些都是仅使用一阶导函数，还可以使用二阶导函数的牛顿法进行优化。</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>训练神经网络</p><p><a href="https://yzd11.github.io/2024/09/21/训练神经网络/">https://yzd11.github.io/2024/09/21/训练神经网络/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>yzd</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2024-09-21</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2024-11-11</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Deep-Learning/">Deep Learning</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2024/10/11/RNN/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">RNN</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2024/09/17/%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB%EF%BC%9AKNN%E5%92%8C%E7%BA%BF%E6%80%A7%E5%88%86%E7%B1%BB%E5%99%A8/"><span class="level-item">图像分类:KNN和线性分类器</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://s2.loli.net/2024/11/11/Ryr92nIiLw3mVQB.jpg" alt="yzd"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">yzd</p><p class="is-size-6 is-block">Computer Science</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>郑州</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">8</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Category</p><a href="/categories"><p class="title">1</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">2</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/yzd11/" target="_blank" rel="me noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/yzd11/"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="语雀" href="https://www.yuque.com/yzd11/myblog/"><i class="fa-solid fa-feather"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="CSDN" href="https://blog.csdn.net/yzd111/"><i class="fa-solid fa-c"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Blog" href="https://yzd.life/"><i class="fa-brands fa-blogger-b"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#MSOSW"><span class="level-left"><span class="level-item">1</span><span class="level-item">激活函数选择</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#xaZzg"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">sigmod</span></span></a></li><li><a class="level is-mobile" href="#jcp7h"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">tanh</span></span></a></li><li><a class="level is-mobile" href="#tf51U"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">ReLU</span></span></a></li><li><a class="level is-mobile" href="#U9BRf"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">Leaky ReLU</span></span></a></li><li><a class="level is-mobile" href="#MXpbp"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">ELU</span></span></a></li><li><a class="level is-mobile" href="#AEV9z"><span class="level-left"><span class="level-item">1.6</span><span class="level-item">Maxout</span></span></a></li></ul></li><li><a class="level is-mobile" href="#cOOxp"><span class="level-left"><span class="level-item">2</span><span class="level-item">数据预处理</span></span></a></li><li><a class="level is-mobile" href="#N8Lvp"><span class="level-left"><span class="level-item">3</span><span class="level-item">权重初始化</span></span></a></li><li><a class="level is-mobile" href="#emxVG"><span class="level-left"><span class="level-item">4</span><span class="level-item">批量归一化</span></span></a></li><li><a class="level is-mobile" href="#wzYCb"><span class="level-left"><span class="level-item">5</span><span class="level-item">优化算法</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#r2WAy"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">SGD</span></span></a></li><li><a class="level is-mobile" href="#lpm3A"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">SGD+Momentum</span></span></a></li><li><a class="level is-mobile" href="#PNqZl"><span class="level-left"><span class="level-item">5.3</span><span class="level-item">Nesterov Momentum</span></span></a></li><li><a class="level is-mobile" href="#cIV0b"><span class="level-left"><span class="level-item">5.4</span><span class="level-item">AdaGrad</span></span></a></li><li><a class="level is-mobile" href="#dd597"><span class="level-left"><span class="level-item">5.5</span><span class="level-item">Adam</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/blog/"><span class="level-start"><span class="level-item">blog</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-11-11T03:57:52.000Z">2024-11-11</time></p><p class="title"><a href="/2024/11/11/Transformer/">Transformer</a></p><p class="categories"><a href="/categories/blog/">blog</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-10-21T02:57:51.000Z">2024-10-21</time></p><p class="title"><a href="/2024/10/21/Self-Attention/">Self-Attention</a></p><p class="categories"><a href="/categories/blog/">blog</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-10-11T04:57:51.000Z">2024-10-11</time></p><p class="title"><a href="/2024/10/11/RNN/">RNN</a></p><p class="categories"><a href="/categories/blog/">blog</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-09-21T04:51:47.000Z">2024-09-21</time></p><p class="title"><a href="/2024/09/21/%E8%AE%AD%E7%BB%83%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/">训练神经网络</a></p><p class="categories"><a href="/categories/blog/">blog</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-09-17T01:57:51.000Z">2024-09-17</time></p><p class="title"><a href="/2024/09/17/%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB%EF%BC%9AKNN%E5%92%8C%E7%BA%BF%E6%80%A7%E5%88%86%E7%B1%BB%E5%99%A8/">图像分类:KNN和线性分类器</a></p><p class="categories"><a href="/categories/blog/">blog</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/11/"><span class="level-start"><span class="level-item">November 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/10/"><span class="level-start"><span class="level-item">October 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/09/"><span class="level-start"><span class="level-item">September 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/08/"><span class="level-start"><span class="level-item">August 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/07/"><span class="level-start"><span class="level-item">July 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Deep-Learning/"><span class="tag">Deep Learning</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DeepLearning/"><span class="tag">DeepLearning</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://s2.loli.net/2024/11/11/wIobSZOAEGchgVv.png" alt="yzd&#039;s Log Book" height="28"></a><p class="is-size-7"><span>&copy; 2024 yzd</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">用💖发电</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/yzd11/"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>